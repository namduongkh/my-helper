!function n(t,e,i){function o(a,l){if(!e[a]){if(!t[a]){var u="function"==typeof require&&require;if(!l&&u)return u(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=e[a]={exports:{}};t[a][0].call(c.exports,function(n){var e=t[a][1][n];return o(e||n)},c,c.exports,n,t,e,i)}return e[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(n,t,e){"use strict";!function(){angular.module("app",["Jackpot","ngclipboard","GetLink","Common","toastr","angular-loading-bar","Graph","ngFacebook"]).config(function(n,t){n.startSymbol("{[{"),n.endSymbol("}]}"),t.setAppId(window.fb_app_id),t.setPermissions("email,publish_actions,user_managed_groups")}).run(function(n){!function(){if(!document.getElementById("facebook-jssdk")){var n=document.getElementsByTagName("script")[0],t=document.createElement("script");t.id="facebook-jssdk",t.src="//connect.facebook.net/en_US/all.js",n.parentNode.insertBefore(t,n)}}()})}(),function(){angular.module("Common",[]).config(function(n){n.startSymbol("{[{"),n.endSymbol("}]}")})}(),function(){angular.module("GetLink",[]).config(function(n){n.startSymbol("{[{"),n.endSymbol("}]}")})}(),function(){angular.module("Graph",[]).config(function(n){n.startSymbol("{[{"),n.endSymbol("}]}")})}(),function(){angular.module("Jackpot",[]).config(function(n){n.startSymbol("{[{"),n.endSymbol("}]}")})}(),function(){function n(){return{publish_email:[{name:"Blog 18",value:"openness.newthinkingnewlife.blog18@blogger.com"}]}}angular.module("Common").service("CommonSvc",n)}(),function(){function n(n,t,e,i,o,r,a,l){var u=this;u.showHtml=!1,u.publish_email=a.publish_email,u.has_publish=!1,u.form={},t.$watch("getContent.view_data",function(n){n&&(n.selector&&(u.form.selector=n.selector),n.url&&(u.form.url=n.url,u.getContent(!0,n.url,n.selector)))}),u.getContent=function(n,t,e,a){if(!n)return void l.error("Form không đủ dữ liệu","Lỗi!");u.has_publish=!1,u.content_data={},r.getContent({url:t}).then(function(n){if(200==n.status)if(n.data.status){var t=document.createElement("div"),r=$(t).html(n.data.content);e&&(r=r.find(e)),u.content_data={title:n.data.title,html:i.trustAsHtml(r.html()),publish_email:u.publish_email[0].value},o(function(){$("#content-result").find("div").on("click",function(){console.log("Clicked!",$(this).find("div")),$(this).find("div").length||this.remove()})}),a&&a()}else l.error("Không lấy được dữ liệu hình ảnh!","Lỗi!");else l.error("Không lấy được dữ liệu hình ảnh!","Lỗi!")}).catch(function(n){console.log("Err",n),l.error("Get image error!","Error!")})},u.getContentManyLink=function(n,t){u.select_publish_email=u.publish_email[0].value,r.getContentManyLink({list_url:n}).then(function(n){200==n.status&&n.data.contents?(u.imageManyLink=n.data.contents.map(function(n){return n.html=i.trustAsHtml(n.image),n}),o(function(){$(".image-many-link").find("img").bind("click",function(){this.remove()})}),t&&t()):l.error("Không lấy được dữ liệu hình ảnh!","Lỗi!")}).catch(function(n){console.log("Err",n),l.error("Get image error!","Error!")})},u.getHtmlImage=function(n){return n?$(n).html():null},u.publish=function(n,t,e){r.publish({html:n,email:t,title:e}).then(function(n){200==n.status&&(l.success("Publish success!","Success!"),$(".close-modal").click()),u.has_publish=!0}).catch(function(){l.error("Publish error!","Error!")})},u.publishMany=function(n,t){n=n.map(function(n){return delete n.html,n}),r.publishMany({contents:n,email:t}).then(function(n){200==n.status&&(l.success("Đã xuất bản","Thành công!"),$(".close-modal").click())}).catch(function(){l.error("Publish error!","Error!")})},u.changeShowHtml=function(){u.showHtml=!u.showHtml},e.$on("GET_IMAGE_FROM_LINK",function(n,t){var e=t.url,i=t.cb;e?u.getContent(e,i):l.error("Không tìm thấy url!","Lỗi!")}),e.$on("GET_IMAGE_FROM_MANY_LINK",function(n,t){var e=t.list_url,i=t.cb;e?u.getContentManyLink(e,i):l.error("Không tìm thấy url!","Lỗi!")}),u.removeFromListLink=function(n){u.imageManyLink.splice(n,1),u.imageManyLink.length||$(".close-modal").click()}}angular.module("GetLink").controller("GetContentController",n)}(),function(){function n(n,t,e,i,o,r,a,l){var u=this;u.showHtml=!1,u.publish_email=a.publish_email,u.has_publish=!1,t.$watch("getImage.view_data",function(n){n&&n.url&&(u.url=n.url,u.getImage(n.url))}),u.getImage=function(n,t){u.has_publish=!1,u.image_data={},r.getImage({url:n}).then(function(n){200==n.status&&n.data.content?(u.image_data={title:n.data.content.title,html:i.trustAsHtml(n.data.content.image),publish_email:u.publish_email[0].value},o(function(){$("#html-result").find("img").bind("click",function(){this.remove()})}),t&&t()):l.error("Không lấy được dữ liệu hình ảnh!","Lỗi!")}).catch(function(n){console.log("Err",n),l.error("Get image error!","Error!")})},u.getImageManyLink=function(n,t){u.select_publish_email=u.publish_email[0].value,r.getImageManyLink({list_url:n}).then(function(n){200==n.status&&n.data.contents?(u.imageManyLink=n.data.contents.map(function(n){return n.html=i.trustAsHtml(n.image),n}),o(function(){$(".image-many-link").find("img").bind("click",function(){this.remove()})}),t&&t()):l.error("Không lấy được dữ liệu hình ảnh!","Lỗi!")}).catch(function(n){console.log("Err",n),l.error("Get image error!","Error!")})},u.getHtmlImage=function(n){return n?"<!--more-->"+$(n).html():null},u.publish=function(n,t,e){r.publish({html:n,email:t,title:e}).then(function(n){200==n.status&&(n.data.status?(l.success("Publish success!","Success!"),$(".close-modal").click()):l.error("Publish error!","Error!")),u.has_publish=!0}).catch(function(){l.error("Publish error!","Error!")})},u.publishMany=function(n,t){n=n.map(function(n){return n.image="<!--more-->"+n.html.$$unwrapTrustedValue(),n}),r.publishMany({contents:n,email:t}).then(function(n){200==n.status&&(l.success("Đã xuất bản","Thành công!"),$(".close-modal").click())}).catch(function(){l.error("Publish error!","Error!")})},u.changeShowHtml=function(){u.showHtml=!u.showHtml},e.$on("GET_IMAGE_FROM_LINK",function(n,t){var e=t.url,i=t.cb;e?u.getImage(e,i):l.error("Không tìm thấy url!","Lỗi!")}),e.$on("GET_IMAGE_FROM_MANY_LINK",function(n,t){var e=t.list_url,i=t.cb;e?u.getImageManyLink(e,i):l.error("Không tìm thấy url!","Lỗi!")}),u.removeFromListLink=function(n){u.imageManyLink.splice(n,1),u.imageManyLink.length||$(".close-modal").click()}}angular.module("GetLink").controller("GetImageController",n)}(),function(){function n(n,t,e,i,o,r,a,l){var u=this;u.publish_email=r.publish_email,n.$watch("getLink.view_data",function(n){n&&n.url&&(u.url=n.url,u.getAllLink())}),u.getAllLink=function(){a.getAllLink({url:u.url,not_allow:u.not_allow}).then(function(n){200==n.status&&n.data.status&&(u.allHref=n.data.href,u.listLink=[])}).catch(function(n){console.log("Err",n),l.error("Get all link error!","Error!")})},u.openGetImage=function(n,e){t.$broadcast("GET_IMAGE_FROM_LINK",{url:n,cb:e})},u.openGetImageModal=function(){$("#openGetImage").modal("show")},u.openGetImageManyLinkModal=function(){$("#openGetImageManyLink").modal("show")},u.getImageManyLink=function(n,e){t.$broadcast("GET_IMAGE_FROM_MANY_LINK",{list_url:n,cb:e})},u.changeListLink=function(n,t){u.selectLink[n]?u.listLink.push(t):u.listLink.splice(u.listLink.indexOf(t),1)},u.checkAll=function(){if(u.listLink=[],u.selectLink=[],u.checkAllLink)for(var n in u.allHref)u.selectLink[n]=!0,u.changeListLink(n,u.allHref[n])}}angular.module("GetLink").controller("GetLinkController",n)}(),function(){function n(n){return{publish:function(t){return n({method:"post",url:"/api/getlink/publish",data:t})},publishMany:function(t){return n({method:"post",url:"/api/getlink/publishMany",data:t})},getImage:function(t){return n({method:"post",url:"/api/getlink/getImage",data:t})},getContent:function(t){return n({method:"post",url:"/api/getlink/getContent",data:t})},getImageManyLink:function(t){return n({method:"post",url:"/api/getlink/getImageManyLink",data:t})},getAllLink:function(t){return n({method:"post",url:"/api/getlink/getAllLink",data:t})}}}angular.module("GetLink").service("GetLinkSvc",n)}(),function(){function n(n,t,e,i){function o(n){i.addFeed({fb_id:r.userInfo.id,message:r.publish_data.message,link:r.publish_data.link,name:r.publish_data.name,feed_id:r.publish_data.feed_id}).then(function(t){e.success("Thành công","Thông báo"),r.feeds=t.data,n&&n()})}var r=this;r.loading=!0,r.groups=[],r.publish_data={},r.getUserInfo=function(){r.userInfo=null,t.api("/me").then(function(n){r.loading=!1,r.userInfo=n,i.getGroups({fb_id:n.id}).then(function(n){r.groups=n.data}),i.getFeeds({fb_id:n.id}).then(function(n){r.feeds=n.data})}).catch(function(n){console.log("err",n),r.loading=!1,e.info("Hãy đăng nhập FB","Thông báo")})},r.login=function(){t.login().then(function(n){r.getUserInfo(),console.log("resp",n)})},r.logout=function(){t.logout().then(function(n){r.getUserInfo(),console.log("resp",n)})},r.addGroup=function(){i.addGroup({fb_id:r.userInfo.id,group_id:r.group_id,group_name:r.group_name}).then(function(n){e.success("Thành công","Thông báo"),r.groups=n.data})},r.publishing=function(n,i){function a(){var n={message:r.publish_data.message};r.publish_data.link&&(n.link=r.publish_data.link),t.api("/"+r.publish_data.group_id+"/feed","POST",n).then(function(n){console.log("resp",n),n&&n.error})}if(!n)return void e.error("Form lỗi","Lỗi");i?o(function(){a()}):a()},r.groupInfo=function(n){t.api("/"+n).then(function(n){console.log("resp",n),n&&!n.error?r.group_name=n.name:e.error("Xảy ra lỗi","Lỗi!")})},r.saveFeed=function(){o()},r.changeFeed=function(n){n&&(r.publish_data.name=n.name,r.publish_data.message=n.message,r.publish_data.link=n.link,r.publish_data.feed_id=n.feed_id)}}angular.module("Graph").controller("GraphController",n)}(),function(){function n(n){return{getGroups:function(t){return n({method:"post",url:"/api/graph/getGroups",data:t})},getFeeds:function(t){return n({method:"post",url:"/api/graph/getFeeds",data:t})},addGroup:function(t){return n({method:"post",url:"/api/graph/addGroup",data:t})},addFeed:function(t){return n({method:"post",url:"/api/graph/addFeed",data:t})}}}angular.module("Graph").service("GraphSvc",n)}(),function(){function n(n,t){var e=this;e.winnings=[],e.getWinningPosition=function(t){n({method:"post",url:"/api/jackpot/getWinningPosition",data:{position:t}}).then(function(n){e.winnings[t]=n.data})},e.getWinnings=function(){for(var n=0;n<6;n++)e.getWinningPosition(n)},e.addWinning=function(){n({method:"post",url:"/api/jackpot/addWinningApi",data:{number:e.add_winning.number,date:e.add_winning.date}}).then(function(n){console.log("Resp",n)})}}angular.module("Jackpot").controller("JackpotController",n)}()},{}]},{},[1]);